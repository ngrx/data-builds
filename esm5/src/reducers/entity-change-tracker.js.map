{"version":3,"file":"entity-change-tracker.js","sourceRoot":"ng://@ngrx/data/","sources":["src/reducers/entity-change-tracker.ts"],"names":[],"mappings":";;;;;;;;;;;;AAUA,yCA2PC;;;;;;;;IApPC,oEAAgE;;;;;;;;IAQhE,qFAGuB;;;;;;;;IAQvB,gFAGuB;;;;;;;;IAYvB,qGAIuB;;;;;;;;;IAavB,iGAIuB;;;;;;;;;IAUvB,gGAIuB;;;;;;;;;IAWvB,oGAIuB;;;;;;;;;;IAcvB,kHAKuB;;;;;;;;;IAYvB,gGAIuB;;;;;;;;;IAUvB,6FAIuB;;;;;;;;;IASvB,+FAIuB;;;;;;;;;IASvB,6FAIuB;;;;;;;;;IASvB,kGAIuB;;;;;;;;;IASvB,gGAIuB;;;;;;;;;IASvB,mGAIuB;;;;;;;;;IASvB,gGAIuB;;;;;;;IASvB,kEAA8D;;;;;;;;IAQ9D,mFAGuB;;;;;;;;IAQvB,8EAGuB","sourcesContent":["import { Update } from '@ngrx/entity';\nimport { EntityCollection } from './entity-collection';\nimport { MergeStrategy } from '../actions/merge-strategy';\nimport { UpdateResponseData } from '../actions/update-response-data';\n\n/**\n * Methods for tracking, committing, and reverting/undoing unsaved entity changes.\n * Used by EntityCollectionReducerMethods which should call tracker methods BEFORE modifying the collection.\n * See EntityChangeTracker docs.\n */\nexport interface EntityChangeTracker<T> {\n  // #region commit\n  /**\n   * Commit all changes as when the collection has been completely reloaded from the server.\n   * Harmless when there are no entity changes to commit.\n   * @param collection The entity collection\n   */\n  commitAll(collection: EntityCollection<T>): EntityCollection<T>;\n\n  /**\n   * Commit changes for the given entities as when they have been refreshed from the server.\n   * Harmless when there are no entity changes to commit.\n   * @param entityOrIdList The entities to clear tracking or their ids.\n   * @param collection The entity collection\n   */\n  commitMany(\n    entityOrIdList: (number | string | T)[],\n    collection: EntityCollection<T>\n  ): EntityCollection<T>;\n\n  /**\n   * Commit changes for the given entity as when it have been refreshed from the server.\n   * Harmless when no entity changes to commit.\n   * @param entityOrId The entity to clear tracking or its id.\n   * @param collection The entity collection\n   */\n  commitOne(\n    entityOrId: number | string | T,\n    collection: EntityCollection<T>\n  ): EntityCollection<T>;\n  // #endregion commit\n\n  // #region mergeQuery\n  /**\n   * Merge query results into the collection, adjusting the ChangeState per the mergeStrategy.\n   * @param entities Entities returned from querying the server.\n   * @param collection The entity collection\n   * @param [mergeStrategy] How to merge a queried entity when the corresponding entity in the collection has an unsaved change.\n   * If not specified, implementation supplies a default strategy.\n   * @returns The merged EntityCollection.\n   */\n  mergeQueryResults(\n    entities: T[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n  // #endregion mergeQuery\n\n  // #region mergeSave\n  /**\n   * Merge result of saving new entities into the collection, adjusting the ChangeState per the mergeStrategy.\n   * The default is MergeStrategy.OverwriteChanges.\n   * @param entities Entities returned from saving new entities to the server.\n   * @param collection The entity collection\n   * @param [mergeStrategy] How to merge a saved entity when the corresponding entity in the collection has an unsaved change.\n   * If not specified, implementation supplies a default strategy.\n   * @returns The merged EntityCollection.\n   */\n  mergeSaveAdds(\n    entities: T[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n  /**\n   * Merge successful result of deleting entities on the server that have the given primary keys\n   * Clears the entity changeState for those keys unless the MergeStrategy is ignoreChanges.\n   * @param entities keys primary keys of the entities to remove/delete.\n   * @param collection The entity collection\n   * @param [mergeStrategy] How to adjust change tracking when the corresponding entity in the collection has an unsaved change.\n   * If not specified, implementation supplies a default strategy.\n   * @returns The merged EntityCollection.\n   */\n  mergeSaveDeletes(\n    keys: (number | string)[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Merge result of saving upserted entities into the collection, adjusting the ChangeState per the mergeStrategy.\n   * The default is MergeStrategy.OverwriteChanges.\n   * @param entities Entities returned from saving upsert entities to the server.\n   * @param collection The entity collection\n   * @param [mergeStrategy] How to merge a saved entity when the corresponding entity in the collection has an unsaved change.\n   * If not specified, implementation supplies a default strategy.\n   * @returns The merged EntityCollection.\n   */\n  mergeSaveUpserts(\n    entities: T[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Merge result of saving updated entities into the collection, adjusting the ChangeState per the mergeStrategy.\n   * The default is MergeStrategy.OverwriteChanges.\n   * @param updates Entity response data returned from saving updated entities to the server.\n   * @param [mergeStrategy] How to merge a saved entity when the corresponding entity in the collection has an unsaved change.\n   * If not specified, implementation supplies a default strategy.\n   * @param [skipUnchanged] True means skip update if server didn't change it. False by default.\n   * If the update was optimistic and the server didn't make more changes of its own\n   * then the updates are already in the collection and shouldn't make them again.\n   * @param collection The entity collection\n   * @returns The merged EntityCollection.\n   */\n  mergeSaveUpdates(\n    updates: UpdateResponseData<T>[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy,\n    skipUnchanged?: boolean\n  ): EntityCollection<T>;\n  // #endregion mergeSave\n\n  // #region track\n  /**\n   * Track multiple entities before adding them to the collection.\n   * Does NOT add to the collection (the reducer's job).\n   * @param entities The entities to add. They must all have their ids.\n   * @param collection The entity collection\n   * @param [mergeStrategy] Track by default. Don't track if is MergeStrategy.IgnoreChanges.\n   * If not specified, implementation supplies a default strategy.\n   */\n  trackAddMany(\n    entities: T[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Track an entity before adding it to the collection.\n   * Does NOT add to the collection (the reducer's job).\n   * @param entity The entity to add. It must have an id.\n   * @param collection The entity collection\n   * @param [mergeStrategy] Track by default. Don't track if is MergeStrategy.IgnoreChanges.\n   * If not specified, implementation supplies a default strategy.\n   */\n  trackAddOne(\n    entity: T,\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Track multiple entities before removing them with the intention of deleting them on the server.\n   * Does NOT remove from the collection (the reducer's job).\n   * @param keys The primary keys of the entities to delete.\n   * @param collection The entity collection\n   * @param [mergeStrategy] Track by default. Don't track if is MergeStrategy.IgnoreChanges.\n   */\n  trackDeleteMany(\n    keys: (number | string)[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Track an entity before it is removed with the intention of deleting it on the server.\n   * Does NOT remove from the collection (the reducer's job).\n   * @param key The primary key of the entity to delete.\n   * @param collection The entity collection\n   * @param [mergeStrategy] Track by default. Don't track if is MergeStrategy.IgnoreChanges.\n   */\n  trackDeleteOne(\n    key: number | string,\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Track multiple entities before updating them in the collection.\n   * Does NOT update the collection (the reducer's job).\n   * @param updates The entities to update.\n   * @param collection The entity collection\n   * @param [mergeStrategy] Track by default. Don't track if is MergeStrategy.IgnoreChanges.\n   */\n  trackUpdateMany(\n    updates: Update<T>[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Track an entity before updating it in the collection.\n   * Does NOT update the collection (the reducer's job).\n   * @param update The entity to update.\n   * @param collection The entity collection\n   * @param [mergeStrategy] Track by default. Don't track if is MergeStrategy.IgnoreChanges.\n   */\n  trackUpdateOne(\n    update: Update<T>,\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Track multiple entities before upserting (adding and updating) them to the collection.\n   * Does NOT update the collection (the reducer's job).\n   * @param entities The entities to add or update. They must be complete entities with ids.\n   * @param collection The entity collection\n   * @param [mergeStrategy] Track by default. Don't track if is MergeStrategy.IgnoreChanges.\n   */\n  trackUpsertMany(\n    entities: T[],\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n\n  /**\n   * Track an entity before upsert (adding and updating) it to the collection.\n   * Does NOT update the collection (the reducer's job).\n   * @param entities The entity to add or update. It must be a complete entity with its id.\n   * @param collection The entity collection\n   * @param [mergeStrategy] Track by default. Don't track if is MergeStrategy.IgnoreChanges.\n   */\n  trackUpsertOne(\n    entity: T,\n    collection: EntityCollection<T>,\n    mergeStrategy?: MergeStrategy\n  ): EntityCollection<T>;\n  // #endregion track\n\n  // #region undo\n  /**\n   * Revert the unsaved changes for all collection.\n   * Harmless when there are no entity changes to undo.\n   * @param collection The entity collection\n   */\n  undoAll(collection: EntityCollection<T>): EntityCollection<T>;\n\n  /**\n   * Revert the unsaved changes for the given entities.\n   * Harmless when there are no entity changes to undo.\n   * @param entityOrIdList The entities to revert or their ids.\n   * @param collection The entity collection\n   */\n  undoMany(\n    entityOrIdList: (number | string | T)[],\n    collection: EntityCollection<T>\n  ): EntityCollection<T>;\n\n  /**\n   * Revert the unsaved changes for the given entity.\n   * Harmless when there are no entity changes to undo.\n   * @param entityOrId The entity to revert or its id.\n   * @param collection The entity collection\n   */\n  undoOne(\n    entityOrId: number | string | T,\n    collection: EntityCollection<T>\n  ): EntityCollection<T>;\n  // #endregion undo\n}\n"]}